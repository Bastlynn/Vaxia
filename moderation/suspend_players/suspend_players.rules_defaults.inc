<?php
/**
 * @file
 * suspend_players.rules_defaults.inc
 */

/**
 * Implements hook_default_rules_configuration().
 */
function suspend_players_default_rules_configuration() {
  $items = array();
  $items['rules_unban_a_banned_user'] = entity_import('rules_config', '{ "rules_unban_a_banned_user" : {
      "LABEL" : "Unban a suspended user",
      "PLUGIN" : "reaction rule",
      "OWNER" : "rules",
      "TAGS" : [ "Suspensions" ],
      "REQUIRES" : [ "rules", "user_stats" ],
      "ON" : { "user_stats_day_older" : [] },
      "IF" : [
        { "user_has_role" : { "account" : [ "user" ], "roles" : { "value" : { "32" : "32" } } } },
        { "user_is_blocked" : { "account" : [ "user" ] } },
        { "NOT data_is_empty" : { "data" : [ "user:field-banned-until" ] } },
        { "data_is" : {
            "data" : [ "user:field-banned-until" ],
            "op" : "\\u003C",
            "value" : "now"
          }
        }
      ],
      "DO" : [
        { "user_add_role" : { "account" : [ "user" ], "roles" : { "value" : { "8" : "8" } } } },
        { "user_remove_role" : { "account" : [ "user" ], "roles" : { "value" : { "32" : "32" } } } },
        { "user_unblock" : { "account" : [ "user" ] } },
        { "data_set" : { "data" : [ "user:field-banned-until" ] } },
        { "mail_to_users_of_role" : {
            "roles" : { "value" : { "3" : "3", "21" : "21" } },
            "subject" : "[Vaxia] [user:name] has been unbanned",
            "message" : "[user:name] has been unbanned.\\r\\n\\r\\nThis email is to let you know that the account has been unbanned. By becoming unbanned, this player\\u0027s characters have been taken out of cold storage and put into draft for resubmission and review by evaluation staff.\\r\\n\\r\\n~~~~~~\\r\\nThis email was automatically generated by vaxia.org.\\r\\nYou are receiving this email as part of your membership at vaxia.org.\\r\\nDo not reply this this email, it is not a monitored account and messages will\\r\\nnot be received by a human.\\r\\n~~~~~~"
          }
        },
        { "mail" : {
            "to" : [ "user:mail" ],
            "subject" : "[Vaxia] Your ban has been lifted",
            "message" : "Your ban has been lifted.\\r\\n\\r\\nThis email is to let you know that your account has been unbanned. By becoming unbanned, your characters have been taken out of cold storage and put into draft for resubmission and review by evaluation staff.\\r\\n\\r\\n~~~~~~\\r\\nThis email was automatically generated by vaxia.org.\\r\\nYou are receiving this email as part of your membership at vaxia.org.\\r\\nDo not reply this this email, it is not a monitored account and messages will\\r\\nnot be received by a human.\\r\\n~~~~~~",
            "language" : [ "" ]
          }
        }
      ]
    }
  }');
  return $items;
}
